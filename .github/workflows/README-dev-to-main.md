# Dev to Main CI/CD Workflow

## 概述

此 GitHub Action workflow 实现了自动化的开发分支到主分支的 CI/CD 流程。

## 工作流程

1. **触发条件**: 当有代码推送到 `dev` 分支时自动触发
2. **构建测试**: 运行 `npm run build` 进行构建测试
3. **自动合并**: 如果构建测试通过，自动将 `dev` 分支合并到 `main` 分支

## 功能特性

### 智能合并检查
- 检查 `dev` 分支是否有新的提交需要合并
- 如果 `main` 分支已经是最新的，则跳过合并

### 安全的合并策略
- 使用 `--no-ff` 选项创建合并提交，保留分支历史
- 自动生成详细的合并提交信息，包含时间戳和构建状态

### 冲突检测
- 如果合并过程中发生冲突，会自动中止合并并报告失败

### 详细日志
- 提供清晰的状态信息和进度反馈
- 包含表情符号的友好输出

## 权限要求

Workflow 需要以下权限：
- `contents: write` - 用于推送合并后的代码到 main 分支
- `pull-requests: write` - 用于可能的 PR 操作（目前未使用）

## 使用方法

1. 确保你的仓库有 `dev` 和 `main` 分支
2. 将代码推送到 `dev` 分支
3. Workflow 会自动运行构建测试
4. 如果测试通过，会自动合并到 `main` 分支

## 注意事项

- 合并提交会使用 `github-actions[bot]` 作为作者
- 建议在推送前在本地测试构建：`npm run build`
- 如果需要修改合并行为，请编辑 `.github/workflows/dev-to-main.yml`

## 故障排除

- **构建失败**: 检查 `npm run build` 是否能在本地正常运行
- **合并冲突**: 手动解决冲突后重新推送，或联系团队成员协助
- **权限问题**: 确保 workflow 有足够的仓库权限
